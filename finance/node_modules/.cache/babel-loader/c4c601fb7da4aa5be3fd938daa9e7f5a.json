{"ast":null,"code":"import { isNullOrUndefined, addClass, extend, closest, updateBlazorTemplate, isBlazor } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { appendChildren, alignFrozenEditForm } from '../base/util';\n/**\n * Edit render module is used to render grid edit row.\n * @hidden\n */\n\nvar InlineEditRender =\n/** @class */\nfunction () {\n  /**\n   * Constructor for render module\n   */\n  function InlineEditRender(parent) {\n    this.parent = parent;\n  }\n\n  InlineEditRender.prototype.addNew = function (elements, args) {\n    this.isEdit = false;\n    var mTbody;\n    var tbody;\n\n    if (this.parent.frozenRows && this.parent.editSettings.newRowPosition === 'Top') {\n      tbody = this.parent.getHeaderContent().querySelector('tbody');\n    } else {\n      tbody = this.parent.getContentTable().querySelector('tbody');\n    }\n\n    args.row = this.parent.createElement('tr', {\n      className: 'e-row e-addedrow'\n    });\n\n    if (tbody.querySelector('.e-emptyrow')) {\n      var emptyRow = tbody.querySelector('.e-emptyrow');\n      emptyRow.parentNode.removeChild(emptyRow);\n\n      if (this.parent.getFrozenColumns()) {\n        var moveTbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n        moveTbody.firstElementChild.parentNode.removeChild(moveTbody.firstElementChild);\n      }\n    }\n\n    this.parent.editSettings.newRowPosition === 'Top' ? tbody.insertBefore(args.row, tbody.firstChild) : tbody.appendChild(args.row);\n    args.row.appendChild(this.getEditElement(elements, false, undefined, args, true));\n    this.parent.editModule.checkLastRow(args.row, args);\n\n    if (this.parent.getFrozenColumns()) {\n      var mEle = this.renderMovableform(args.row, args);\n\n      if (this.parent.frozenRows && this.parent.editSettings.newRowPosition === 'Top') {\n        mTbody = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('tbody');\n      } else {\n        mTbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n      }\n\n      this.parent.editSettings.newRowPosition === 'Top' ? mTbody.insertBefore(mEle, mTbody.firstChild) : mTbody.appendChild(mEle);\n      args.row.querySelector('.e-normaledit').setAttribute('colspan', this.parent.getVisibleFrozenColumns() + '');\n      mEle.setAttribute('colspan', '' + (this.parent.getVisibleColumns().length - this.parent.getVisibleFrozenColumns()));\n\n      if (this.parent.height === 'auto') {\n        this.parent.notify(events.frozenHeight, {});\n      }\n    }\n  };\n\n  InlineEditRender.prototype.renderMovableform = function (ele, args) {\n    var mEle = ele.cloneNode(true);\n    var form = args.movableForm = mEle.querySelector('form');\n\n    if (this.parent.editSettings.template) {\n      form.innerHTML = '';\n      this.appendChildren(form, args.rowData, false);\n      return mEle;\n    }\n\n    this.renderMovable(ele, mEle);\n    mEle.querySelector('colgroup').innerHTML = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup').innerHTML;\n    return mEle;\n  };\n\n  InlineEditRender.prototype.updateFreezeEdit = function (row, td) {\n    td = td.concat([].slice.call(this.getFreezeRow(row).querySelectorAll('td.e-rowcell')));\n    return td;\n  };\n\n  InlineEditRender.prototype.getFreezeRow = function (row) {\n    if (this.parent.getFrozenColumns()) {\n      var idx = parseInt(row.getAttribute('aria-rowindex'), 10);\n      var fCont = this.parent.getContent().querySelector('.e-frozencontent').querySelector('tbody');\n      var mCont = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n      var fHdr = this.parent.getHeaderContent().querySelector('.e-frozenheader').querySelector('tbody');\n      var mHdr = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('tbody');\n\n      if (this.parent.frozenRows && idx >= this.parent.frozenRows) {\n        idx -= this.parent.frozenRows;\n      }\n\n      if (fCont.contains(row)) {\n        if (this.parent.infiniteScrollSettings.enableCache) {\n          return this.parent.getMovableRowByIndex(idx);\n        }\n\n        return mCont.children[idx];\n      } else if (mCont.contains(row)) {\n        if (this.parent.infiniteScrollSettings.enableCache) {\n          return this.parent.getRowByIndex(idx);\n        }\n\n        return fCont.children[idx];\n      } else if (fHdr.contains(row)) {\n        return mHdr.children[idx];\n      } else if (mHdr.contains(row)) {\n        return fHdr.children[idx];\n      }\n    }\n\n    return row;\n  };\n\n  InlineEditRender.prototype.update = function (elements, args) {\n    this.isEdit = true;\n    var cloneRow = 'cloneRow';\n\n    if (closest(args.row, '.e-movablecontent')) {\n      args.row = this.getFreezeRow(args.row);\n\n      if (isBlazor() && this.parent.isServerRendered) {\n        args[cloneRow] = args.row.cloneNode(true);\n      }\n    }\n\n    if (isBlazor() && this.parent.isServerRendered) {\n      args.row.parentNode.insertBefore(args[cloneRow], args.row);\n      args.row.classList.add('e-hiddenrow');\n      var tdElement = [].slice.call(args[cloneRow].querySelectorAll('td.e-rowcell'));\n      args[cloneRow].innerHTML = '';\n      tdElement = this.updateFreezeEdit(args[cloneRow], tdElement);\n      args[cloneRow].appendChild(this.getEditElement(elements, true, tdElement, args, true));\n      args[cloneRow].classList.add('e-editedrow');\n      this.refreshFreezeEdit(args[cloneRow], args);\n    } else {\n      var tdElement = [].slice.call(args.row.querySelectorAll('td.e-rowcell'));\n      args.row.innerHTML = '';\n      tdElement = this.updateFreezeEdit(args.row, tdElement);\n      args.row.appendChild(this.getEditElement(elements, true, tdElement, args, true));\n      args.row.classList.add('e-editedrow');\n      this.parent.editModule.checkLastRow(args.row, args);\n      this.refreshFreezeEdit(args.row, args);\n    }\n  };\n\n  InlineEditRender.prototype.refreshFreezeEdit = function (row, args) {\n    var td = row.firstChild;\n    var fCls;\n    var cont;\n    var frozen = 'frozen';\n    var cloneFrozen = 'cloneFrozen';\n    var idx = parseInt(row.getAttribute('aria-rowindex'), 10);\n\n    if (this.parent.getFrozenColumns()) {\n      if (idx < this.parent.frozenRows) {\n        cont = this.parent.getHeaderContent();\n        fCls = '.e-frozenheader';\n      } else {\n        cont = this.parent.getContent();\n        fCls = '.e-frozencontent';\n      }\n\n      var mTd = td.cloneNode(true);\n      var form = args.movableForm = mTd.querySelector('form');\n\n      if (this.parent.editSettings.template) {\n        form.innerHTML = '';\n        this.appendChildren(form, args.rowData, false);\n      }\n\n      var fRows = void 0;\n\n      if (cont.querySelector(fCls).contains(row)) {\n        fRows = this.parent.getMovableRowByIndex(idx);\n\n        if (isBlazor() && this.parent.isServerRendered) {\n          args[frozen] = fRows;\n          args[cloneFrozen] = fRows.cloneNode(true);\n          fRows.classList.add('e-hiddenrow');\n          fRows.parentNode.insertBefore(args[cloneFrozen], fRows);\n          this.updateFrozenCont(args[cloneFrozen], td, mTd);\n        } else {\n          this.updateFrozenCont(fRows, td, mTd);\n        }\n      } else {\n        fRows = this.parent.getRowByIndex(idx);\n\n        if (isBlazor() && this.parent.isServerRendered) {\n          args[frozen] = fRows;\n          args[cloneFrozen] = fRows.cloneNode(true);\n          fRows.parentNode.insertBefore(args[cloneFrozen], fRows);\n          fRows.classList.add('e-hiddenrow');\n          this.updateFrozenCont(args[cloneFrozen], mTd, td);\n        } else {\n          this.updateFrozenCont(fRows, mTd, td);\n        }\n      }\n\n      if (isBlazor() && this.parent.isServerRendered) {\n        args[cloneFrozen].appendChild(mTd);\n        args[cloneFrozen].classList.add('e-editedrow');\n      } else {\n        fRows.appendChild(mTd);\n        fRows.classList.add('e-editedrow');\n      }\n\n      alignFrozenEditForm(args.movableForm.querySelector('td:not(.e-hide)'), args.form.querySelector('td:not(.e-hide)'));\n    }\n  };\n\n  InlineEditRender.prototype.updateFrozenCont = function (row, ele, mEle) {\n    row.innerHTML = '';\n\n    if (!this.parent.editSettings.template) {\n      this.renderMovable(ele, mEle);\n      mEle.querySelector('colgroup').innerHTML = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('colgroup').innerHTML;\n    }\n\n    ele.setAttribute('colspan', this.parent.getVisibleFrozenColumns() + '');\n    mEle.setAttribute('colspan', this.parent.getVisibleColumns().length - this.parent.getVisibleFrozenColumns() + '');\n  };\n\n  InlineEditRender.prototype.renderMovable = function (ele, mEle) {\n    var frzCols = this.parent.getFrozenColumns();\n    mEle.querySelector('tr').innerHTML = '';\n\n    for (var i = frzCols; i < this.parent.getColumns().length; i++) {\n      mEle.querySelector('tr').appendChild(ele.querySelector('tr').removeChild(ele.querySelector('tr').children[frzCols]));\n    }\n  };\n\n  InlineEditRender.prototype.getEditElement = function (elements, isEdit, tdElement, args, isFrozen) {\n    var gObj = this.parent;\n    var gLen = 0;\n    var isDetail = !isNullOrUndefined(gObj.detailTemplate) || !isNullOrUndefined(gObj.childGrid) ? 1 : 0;\n\n    if (gObj.allowGrouping) {\n      gLen = gObj.groupSettings.columns.length;\n    }\n\n    var td = this.parent.createElement('td', {\n      className: 'e-editcell e-normaledit',\n      attrs: {\n        colspan: (gObj.getVisibleColumns().length - gObj.getVisibleFrozenColumns() + this.parent.getIndentCount()).toString()\n      }\n    });\n    var form = args.form = this.parent.createElement('form', {\n      id: gObj.element.id + 'EditForm',\n      className: 'e-gridform'\n    });\n\n    if (this.parent.editSettings.template) {\n      this.appendChildren(form, args.rowData, isFrozen);\n      td.appendChild(form);\n      return td;\n    }\n\n    var table = this.parent.createElement('table', {\n      className: 'e-table e-inline-edit',\n      attrs: {\n        cellspacing: '0.25'\n      }\n    });\n    table.appendChild(gObj.getContentTable().querySelector('colgroup').cloneNode(true));\n    var tbody = this.parent.createElement('tbody');\n    var tr = this.parent.createElement('tr');\n    var i = 0;\n\n    if (isDetail) {\n      tr.insertBefore(this.parent.createElement('td', {\n        className: 'e-detailrowcollapse'\n      }), tr.firstChild);\n    }\n\n    if (gObj.isRowDragable()) {\n      tr.appendChild(this.parent.createElement('td', {\n        className: 'e-dragindentcell'\n      }));\n    }\n\n    while (i < gLen) {\n      tr.appendChild(this.parent.createElement('td', {\n        className: 'e-indentcell'\n      }));\n      i++;\n    }\n\n    var m = 0;\n    i = 0;\n\n    while (isEdit && m < tdElement.length && i < gObj.getColumns().length || i < gObj.getColumns().length) {\n      var span = isEdit ? tdElement[m].getAttribute('colspan') : null;\n      var col = gObj.getColumns()[i];\n      var td_1 = this.parent.createElement('td', {\n        className: 'e-rowcell',\n        attrs: {\n          style: 'text-align:' + (col.textAlign ? col.textAlign : ''),\n          'colspan': span ? span : ''\n        }\n      });\n\n      if (col.visible) {\n        td_1.appendChild(elements[col.uid]);\n\n        if (col.editType === 'booleanedit') {\n          td_1.classList.add('e-boolcell');\n        } else if (col.commands || col.commandsTemplate) {\n          addClass([td_1], 'e-unboundcell');\n        }\n      } else {\n        td_1.classList.add('e-hide');\n      }\n\n      tr.appendChild(td_1);\n      i = span ? i + parseInt(span, 10) : i + 1;\n      m++;\n    }\n\n    tbody.appendChild(tr);\n    table.appendChild(tbody);\n    form.appendChild(table);\n    td.appendChild(form);\n    return td;\n  };\n\n  InlineEditRender.prototype.removeEventListener = function () {//To destroy the renderer\n  };\n\n  InlineEditRender.prototype.appendChildren = function (form, data, isFrozen) {\n    var _this = this;\n\n    var dummyData = extend({}, data, {\n      isAdd: !this.isEdit,\n      isFrozen: isFrozen\n    }, true);\n    var editTemplateID = this.parent.element.id + 'editSettingsTemplate';\n    appendChildren(form, this.parent.getEditTemplate()(dummyData, this.parent, 'editSettingsTemplate', editTemplateID));\n\n    var setRules = function () {\n      var cols = _this.parent.getColumns();\n\n      for (var i = 0; i < cols.length; i++) {\n        if (cols[i].validationRules) {\n          _this.parent.editModule.formObj.rules[cols[i].field] = cols[i].validationRules;\n        }\n      }\n    };\n\n    updateBlazorTemplate(editTemplateID, 'Template', this.parent.editSettings, true, setRules);\n  };\n\n  return InlineEditRender;\n}();\n\nexport { InlineEditRender };","map":{"version":3,"sources":["D:/Projects/TCC/Finances/node_modules/@syncfusion/ej2-grids/src/grid/renderer/inline-edit-renderer.js"],"names":["isNullOrUndefined","addClass","extend","closest","updateBlazorTemplate","isBlazor","events","appendChildren","alignFrozenEditForm","InlineEditRender","parent","prototype","addNew","elements","args","isEdit","mTbody","tbody","frozenRows","editSettings","newRowPosition","getHeaderContent","querySelector","getContentTable","row","createElement","className","emptyRow","parentNode","removeChild","getFrozenColumns","moveTbody","getContent","firstElementChild","insertBefore","firstChild","appendChild","getEditElement","undefined","editModule","checkLastRow","mEle","renderMovableform","setAttribute","getVisibleFrozenColumns","getVisibleColumns","length","height","notify","frozenHeight","ele","cloneNode","form","movableForm","template","innerHTML","rowData","renderMovable","updateFreezeEdit","td","concat","slice","call","getFreezeRow","querySelectorAll","idx","parseInt","getAttribute","fCont","mCont","fHdr","mHdr","contains","infiniteScrollSettings","enableCache","getMovableRowByIndex","children","getRowByIndex","update","cloneRow","isServerRendered","classList","add","tdElement","refreshFreezeEdit","fCls","cont","frozen","cloneFrozen","mTd","fRows","updateFrozenCont","frzCols","i","getColumns","isFrozen","gObj","gLen","isDetail","detailTemplate","childGrid","allowGrouping","groupSettings","columns","attrs","colspan","getIndentCount","toString","id","element","table","cellspacing","tr","isRowDragable","m","span","col","td_1","style","textAlign","visible","uid","editType","commands","commandsTemplate","removeEventListener","data","_this","dummyData","isAdd","editTemplateID","getEditTemplate","setRules","cols","validationRules","formObj","rules","field"],"mappings":"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","sourcesContent":["import { isNullOrUndefined, addClass, extend, closest, updateBlazorTemplate, isBlazor } from '@syncfusion/ej2-base';\nimport * as events from '../base/constant';\nimport { appendChildren, alignFrozenEditForm } from '../base/util';\n/**\n * Edit render module is used to render grid edit row.\n * @hidden\n */\nvar InlineEditRender = /** @class */ (function () {\n    /**\n     * Constructor for render module\n     */\n    function InlineEditRender(parent) {\n        this.parent = parent;\n    }\n    InlineEditRender.prototype.addNew = function (elements, args) {\n        this.isEdit = false;\n        var mTbody;\n        var tbody;\n        if (this.parent.frozenRows && this.parent.editSettings.newRowPosition === 'Top') {\n            tbody = this.parent.getHeaderContent().querySelector('tbody');\n        }\n        else {\n            tbody = this.parent.getContentTable().querySelector('tbody');\n        }\n        args.row = this.parent.createElement('tr', { className: 'e-row e-addedrow' });\n        if (tbody.querySelector('.e-emptyrow')) {\n            var emptyRow = tbody.querySelector('.e-emptyrow');\n            emptyRow.parentNode.removeChild(emptyRow);\n            if (this.parent.getFrozenColumns()) {\n                var moveTbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n                (moveTbody.firstElementChild).parentNode.removeChild(moveTbody.firstElementChild);\n            }\n        }\n        this.parent.editSettings.newRowPosition === 'Top' ? tbody.insertBefore(args.row, tbody.firstChild) : tbody.appendChild(args.row);\n        args.row.appendChild(this.getEditElement(elements, false, undefined, args, true));\n        this.parent.editModule.checkLastRow(args.row, args);\n        if (this.parent.getFrozenColumns()) {\n            var mEle = this.renderMovableform(args.row, args);\n            if (this.parent.frozenRows && this.parent.editSettings.newRowPosition === 'Top') {\n                mTbody = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('tbody');\n            }\n            else {\n                mTbody = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n            }\n            this.parent.editSettings.newRowPosition === 'Top' ? mTbody.insertBefore(mEle, mTbody.firstChild) : mTbody.appendChild(mEle);\n            args.row.querySelector('.e-normaledit').setAttribute('colspan', this.parent.getVisibleFrozenColumns() + '');\n            mEle.setAttribute('colspan', '' + (this.parent.getVisibleColumns().length - this.parent.getVisibleFrozenColumns()));\n            if (this.parent.height === 'auto') {\n                this.parent.notify(events.frozenHeight, {});\n            }\n        }\n    };\n    InlineEditRender.prototype.renderMovableform = function (ele, args) {\n        var mEle = ele.cloneNode(true);\n        var form = args.movableForm = mEle.querySelector('form');\n        if (this.parent.editSettings.template) {\n            form.innerHTML = '';\n            this.appendChildren(form, args.rowData, false);\n            return mEle;\n        }\n        this.renderMovable(ele, mEle);\n        mEle.querySelector('colgroup').innerHTML = this.parent.getHeaderContent()\n            .querySelector('.e-movableheader').querySelector('colgroup').innerHTML;\n        return mEle;\n    };\n    InlineEditRender.prototype.updateFreezeEdit = function (row, td) {\n        td = td.concat([].slice.call(this.getFreezeRow(row).querySelectorAll('td.e-rowcell')));\n        return td;\n    };\n    InlineEditRender.prototype.getFreezeRow = function (row) {\n        if (this.parent.getFrozenColumns()) {\n            var idx = parseInt(row.getAttribute('aria-rowindex'), 10);\n            var fCont = this.parent.getContent().querySelector('.e-frozencontent').querySelector('tbody');\n            var mCont = this.parent.getContent().querySelector('.e-movablecontent').querySelector('tbody');\n            var fHdr = this.parent.getHeaderContent().querySelector('.e-frozenheader').querySelector('tbody');\n            var mHdr = this.parent.getHeaderContent().querySelector('.e-movableheader').querySelector('tbody');\n            if (this.parent.frozenRows && idx >= this.parent.frozenRows) {\n                idx -= this.parent.frozenRows;\n            }\n            if (fCont.contains(row)) {\n                if (this.parent.infiniteScrollSettings.enableCache) {\n                    return this.parent.getMovableRowByIndex(idx);\n                }\n                return mCont.children[idx];\n            }\n            else if (mCont.contains(row)) {\n                if (this.parent.infiniteScrollSettings.enableCache) {\n                    return this.parent.getRowByIndex(idx);\n                }\n                return fCont.children[idx];\n            }\n            else if (fHdr.contains(row)) {\n                return mHdr.children[idx];\n            }\n            else if (mHdr.contains(row)) {\n                return fHdr.children[idx];\n            }\n        }\n        return row;\n    };\n    InlineEditRender.prototype.update = function (elements, args) {\n        this.isEdit = true;\n        var cloneRow = 'cloneRow';\n        if (closest(args.row, '.e-movablecontent')) {\n            args.row = this.getFreezeRow(args.row);\n            if (isBlazor() && this.parent.isServerRendered) {\n                args[cloneRow] = args.row.cloneNode(true);\n            }\n        }\n        if (isBlazor() && this.parent.isServerRendered) {\n            args.row.parentNode.insertBefore(args[cloneRow], args.row);\n            args.row.classList.add('e-hiddenrow');\n            var tdElement = [].slice.call(args[cloneRow].querySelectorAll('td.e-rowcell'));\n            args[cloneRow].innerHTML = '';\n            tdElement = this.updateFreezeEdit(args[cloneRow], tdElement);\n            args[cloneRow].appendChild(this.getEditElement(elements, true, tdElement, args, true));\n            args[cloneRow].classList.add('e-editedrow');\n            this.refreshFreezeEdit(args[cloneRow], args);\n        }\n        else {\n            var tdElement = [].slice.call(args.row.querySelectorAll('td.e-rowcell'));\n            args.row.innerHTML = '';\n            tdElement = this.updateFreezeEdit(args.row, tdElement);\n            args.row.appendChild(this.getEditElement(elements, true, tdElement, args, true));\n            args.row.classList.add('e-editedrow');\n            this.parent.editModule.checkLastRow(args.row, args);\n            this.refreshFreezeEdit(args.row, args);\n        }\n    };\n    InlineEditRender.prototype.refreshFreezeEdit = function (row, args) {\n        var td = row.firstChild;\n        var fCls;\n        var cont;\n        var frozen = 'frozen';\n        var cloneFrozen = 'cloneFrozen';\n        var idx = parseInt(row.getAttribute('aria-rowindex'), 10);\n        if (this.parent.getFrozenColumns()) {\n            if (idx < this.parent.frozenRows) {\n                cont = this.parent.getHeaderContent();\n                fCls = '.e-frozenheader';\n            }\n            else {\n                cont = this.parent.getContent();\n                fCls = '.e-frozencontent';\n            }\n            var mTd = td.cloneNode(true);\n            var form = args.movableForm = mTd.querySelector('form');\n            if (this.parent.editSettings.template) {\n                form.innerHTML = '';\n                this.appendChildren(form, args.rowData, false);\n            }\n            var fRows = void 0;\n            if (cont.querySelector(fCls).contains(row)) {\n                fRows = this.parent.getMovableRowByIndex(idx);\n                if (isBlazor() && this.parent.isServerRendered) {\n                    args[frozen] = fRows;\n                    args[cloneFrozen] = fRows.cloneNode(true);\n                    fRows.classList.add('e-hiddenrow');\n                    fRows.parentNode.insertBefore(args[cloneFrozen], fRows);\n                    this.updateFrozenCont(args[cloneFrozen], td, mTd);\n                }\n                else {\n                    this.updateFrozenCont(fRows, td, mTd);\n                }\n            }\n            else {\n                fRows = this.parent.getRowByIndex(idx);\n                if (isBlazor() && this.parent.isServerRendered) {\n                    args[frozen] = fRows;\n                    args[cloneFrozen] = fRows.cloneNode(true);\n                    fRows.parentNode.insertBefore(args[cloneFrozen], fRows);\n                    fRows.classList.add('e-hiddenrow');\n                    this.updateFrozenCont(args[cloneFrozen], mTd, td);\n                }\n                else {\n                    this.updateFrozenCont(fRows, mTd, td);\n                }\n            }\n            if (isBlazor() && this.parent.isServerRendered) {\n                args[cloneFrozen].appendChild(mTd);\n                args[cloneFrozen].classList.add('e-editedrow');\n            }\n            else {\n                fRows.appendChild(mTd);\n                fRows.classList.add('e-editedrow');\n            }\n            alignFrozenEditForm(args.movableForm.querySelector('td:not(.e-hide)'), args.form.querySelector('td:not(.e-hide)'));\n        }\n    };\n    InlineEditRender.prototype.updateFrozenCont = function (row, ele, mEle) {\n        row.innerHTML = '';\n        if (!this.parent.editSettings.template) {\n            this.renderMovable(ele, mEle);\n            mEle.querySelector('colgroup').innerHTML = this.parent.getHeaderContent()\n                .querySelector('.e-movableheader').querySelector('colgroup').innerHTML;\n        }\n        ele.setAttribute('colspan', this.parent.getVisibleFrozenColumns() + '');\n        mEle.setAttribute('colspan', this.parent.getVisibleColumns().length - this.parent.getVisibleFrozenColumns() + '');\n    };\n    InlineEditRender.prototype.renderMovable = function (ele, mEle) {\n        var frzCols = this.parent.getFrozenColumns();\n        mEle.querySelector('tr').innerHTML = '';\n        for (var i = frzCols; i < this.parent.getColumns().length; i++) {\n            mEle.querySelector('tr').appendChild(ele.querySelector('tr').removeChild(ele.querySelector('tr').children[frzCols]));\n        }\n    };\n    InlineEditRender.prototype.getEditElement = function (elements, isEdit, tdElement, args, isFrozen) {\n        var gObj = this.parent;\n        var gLen = 0;\n        var isDetail = !isNullOrUndefined(gObj.detailTemplate) || !isNullOrUndefined(gObj.childGrid) ? 1 : 0;\n        if (gObj.allowGrouping) {\n            gLen = gObj.groupSettings.columns.length;\n        }\n        var td = this.parent.createElement('td', {\n            className: 'e-editcell e-normaledit',\n            attrs: { colspan: (gObj.getVisibleColumns().length - gObj.getVisibleFrozenColumns() + this.parent.getIndentCount()).toString() }\n        });\n        var form = args.form =\n            this.parent.createElement('form', { id: gObj.element.id + 'EditForm', className: 'e-gridform' });\n        if (this.parent.editSettings.template) {\n            this.appendChildren(form, args.rowData, isFrozen);\n            td.appendChild(form);\n            return td;\n        }\n        var table = this.parent.createElement('table', { className: 'e-table e-inline-edit', attrs: { cellspacing: '0.25' } });\n        table.appendChild(gObj.getContentTable().querySelector('colgroup').cloneNode(true));\n        var tbody = this.parent.createElement('tbody');\n        var tr = this.parent.createElement('tr');\n        var i = 0;\n        if (isDetail) {\n            tr.insertBefore(this.parent.createElement('td', { className: 'e-detailrowcollapse' }), tr.firstChild);\n        }\n        if (gObj.isRowDragable()) {\n            tr.appendChild(this.parent.createElement('td', { className: 'e-dragindentcell' }));\n        }\n        while (i < gLen) {\n            tr.appendChild(this.parent.createElement('td', { className: 'e-indentcell' }));\n            i++;\n        }\n        var m = 0;\n        i = 0;\n        while ((isEdit && m < tdElement.length && i < gObj.getColumns().length) || i < gObj.getColumns().length) {\n            var span = isEdit ? tdElement[m].getAttribute('colspan') : null;\n            var col = gObj.getColumns()[i];\n            var td_1 = this.parent.createElement('td', {\n                className: 'e-rowcell', attrs: { style: 'text-align:' + (col.textAlign ? col.textAlign : ''), 'colspan': span ? span : '' }\n            });\n            if (col.visible) {\n                td_1.appendChild(elements[col.uid]);\n                if (col.editType === 'booleanedit') {\n                    td_1.classList.add('e-boolcell');\n                }\n                else if (col.commands || col.commandsTemplate) {\n                    addClass([td_1], 'e-unboundcell');\n                }\n            }\n            else {\n                td_1.classList.add('e-hide');\n            }\n            tr.appendChild(td_1);\n            i = span ? i + parseInt(span, 10) : i + 1;\n            m++;\n        }\n        tbody.appendChild(tr);\n        table.appendChild(tbody);\n        form.appendChild(table);\n        td.appendChild(form);\n        return td;\n    };\n    InlineEditRender.prototype.removeEventListener = function () {\n        //To destroy the renderer\n    };\n    InlineEditRender.prototype.appendChildren = function (form, data, isFrozen) {\n        var _this = this;\n        var dummyData = extend({}, data, { isAdd: !this.isEdit, isFrozen: isFrozen }, true);\n        var editTemplateID = this.parent.element.id + 'editSettingsTemplate';\n        appendChildren(form, this.parent.getEditTemplate()(dummyData, this.parent, 'editSettingsTemplate', editTemplateID));\n        var setRules = function () {\n            var cols = _this.parent.getColumns();\n            for (var i = 0; i < cols.length; i++) {\n                if (cols[i].validationRules) {\n                    _this.parent.editModule.formObj.rules[cols[i].field] =\n                        cols[i].validationRules;\n                }\n            }\n        };\n        updateBlazorTemplate(editTemplateID, 'Template', this.parent.editSettings, true, setRules);\n    };\n    return InlineEditRender;\n}());\nexport { InlineEditRender };\n"]},"metadata":{},"sourceType":"module"}