{"ast":null,"code":"import { Browser, EventHandler } from '@syncfusion/ej2-base';\nimport { addClass, removeClass } from '@syncfusion/ej2-base';\nimport { formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getScrollBarWidth, getUpdateUsingRaf } from '../base/util';\nimport { scroll, contentReady, uiUpdate, onEmpty, headerRefreshed, textWrapRefresh, virtualScrollEdit, infiniteScrollHandler, closeFilterDialog } from '../base/constant';\nimport { lazyLoadScrollHandler } from '../base/constant';\nimport { ColumnWidthService } from '../services/width-controller';\n/**\n * The `Scroll` module is used to handle scrolling behaviour.\n */\n\nvar Scroll =\n/** @class */\nfunction () {\n  /**\n   * Constructor for the Grid scrolling.\n   * @hidden\n   */\n  function Scroll(parent) {\n    this.lastScrollTop = 0; //To maintain scroll state on grid actions.\n\n    this.previousValues = {\n      top: 0,\n      left: 0\n    };\n    this.oneTimeReady = true;\n    this.parent = parent;\n    this.widthService = new ColumnWidthService(parent);\n    this.addEventListener();\n  }\n  /**\n   * For internal use only - Get the module name.\n   * @private\n   */\n\n\n  Scroll.prototype.getModuleName = function () {\n    return 'scroll';\n  };\n  /**\n   * @hidden\n   */\n\n\n  Scroll.prototype.setWidth = function (uiupdate) {\n    this.parent.element.style.width = formatUnit(this.parent.width);\n\n    if (uiupdate) {\n      this.widthService.setWidthToColumns();\n    }\n\n    if (this.parent.toolbarModule && this.parent.toolbarModule.toolbar && this.parent.toolbarModule.toolbar.element) {\n      this.parent.toolbarModule.toolbar.refreshOverflow();\n    }\n  };\n  /**\n   * @hidden\n   */\n\n\n  Scroll.prototype.setHeight = function () {\n    var mHdrHeight = 0;\n    var content = this.parent.getContent().querySelector('.e-content');\n\n    if (!this.parent.enableVirtualization && this.parent.frozenRows && this.parent.height !== 'auto') {\n      var tbody = this.parent.getHeaderContent().querySelector('tbody');\n      mHdrHeight = tbody ? tbody.offsetHeight : 0;\n      content.style.height = formatUnit(this.parent.height - mHdrHeight);\n    } else {\n      content.style.height = formatUnit(this.parent.height);\n    }\n\n    this.ensureOverflow(content);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Scroll.prototype.setPadding = function () {\n    var content = this.parent.getHeaderContent();\n    var scrollWidth = Scroll.getScrollBarWidth() - this.getThreshold();\n    var cssProps = this.getCssProperties();\n    content.querySelector('.e-headercontent').style[cssProps.border] = scrollWidth > 0 ? '1px' : '0px';\n    content.style[cssProps.padding] = scrollWidth > 0 ? scrollWidth + 'px' : '0px';\n  };\n  /**\n   * @hidden\n   */\n\n\n  Scroll.prototype.removePadding = function (rtl) {\n    var cssProps = this.getCssProperties(rtl);\n    var hDiv = this.parent.getHeaderContent().querySelector('.e-headercontent');\n    hDiv.style[cssProps.border] = '';\n    hDiv.parentElement.style[cssProps.padding] = '';\n    var footerDiv = this.parent.getFooterContent();\n\n    if (footerDiv && footerDiv.classList.contains('e-footerpadding')) {\n      footerDiv.classList.remove('e-footerpadding');\n    }\n  };\n  /**\n   * Refresh makes the Grid adoptable with the height of parent container.\n   *\n   * > The [`height`](grid/#height/) must be set to 100%.\n   * @return\n   */\n\n\n  Scroll.prototype.refresh = function () {\n    if (this.parent.height !== '100%') {\n      return;\n    }\n\n    var content = this.parent.getContent();\n    this.parent.element.style.height = '100%';\n    var height = this.widthService.getSiblingsHeight(content);\n    content.style.height = 'calc(100% - ' + height + 'px)'; //Set the height to the '.e-gridcontent';\n  };\n\n  Scroll.prototype.getThreshold = function () {\n    /* Some browsers places the scroller outside the content,\n     * hence the padding should be adjusted.*/\n    var appName = Browser.info.name;\n\n    if (appName === 'mozilla') {\n      return 0.5;\n    }\n\n    return 1;\n  };\n  /**\n   * @hidden\n   */\n\n\n  Scroll.prototype.addEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.on(onEmpty, this.wireEvents, this);\n    this.parent.on(contentReady, this.wireEvents, this);\n    this.parent.on(uiUpdate, this.onPropertyChanged, this);\n    this.parent.on(textWrapRefresh, this.wireEvents, this);\n    this.parent.on(headerRefreshed, this.setScrollLeft, this);\n  };\n  /**\n   * @hidden\n   */\n\n\n  Scroll.prototype.removeEventListener = function () {\n    if (this.parent.isDestroyed) {\n      return;\n    }\n\n    this.parent.off(onEmpty, this.wireEvents);\n    this.parent.off(contentReady, this.wireEvents);\n    this.parent.off(uiUpdate, this.onPropertyChanged);\n    this.parent.off(textWrapRefresh, this.wireEvents);\n    this.parent.off(headerRefreshed, this.setScrollLeft);\n  };\n\n  Scroll.prototype.setScrollLeft = function () {\n    if (this.parent.frozenColumns) {\n      this.parent.headerModule.getMovableHeader().scrollLeft = this.previousValues.left;\n    } else {\n      this.parent.getHeaderContent().querySelector('.e-headercontent').scrollLeft = this.previousValues.left;\n    }\n  };\n\n  Scroll.prototype.onContentScroll = function (scrollTarget) {\n    var _this = this;\n\n    var element = scrollTarget;\n    var isHeader = element.classList.contains('e-headercontent');\n    return function (e) {\n      if (_this.content.querySelector('tbody') === null || _this.parent.isPreventScrollEvent) {\n        return;\n      }\n\n      if (!isNullOrUndefined(_this.parent.infiniteScrollModule) && _this.parent.enableInfiniteScrolling) {\n        _this.parent.notify(infiniteScrollHandler, e);\n      }\n\n      if (_this.parent.groupSettings.columns.length && _this.parent.groupSettings.enableLazyLoading) {\n        var isDown = _this.previousValues.top < _this.parent.getContent().firstElementChild.scrollTop;\n\n        _this.parent.notify(lazyLoadScrollHandler, {\n          scrollDown: isDown\n        });\n      }\n\n      _this.parent.notify(virtualScrollEdit, {});\n\n      var target = e.target;\n      var left = target.scrollLeft;\n      var sLimit = target.scrollWidth;\n      var isFooter = target.classList.contains('e-summarycontent');\n\n      if (_this.previousValues.left === left) {\n        _this.previousValues.top = !isHeader ? _this.previousValues.top : target.scrollTop;\n        return;\n      }\n\n      _this.parent.notify(closeFilterDialog, e);\n\n      element.scrollLeft = left;\n\n      if (isFooter) {\n        _this.header.scrollLeft = left;\n      }\n\n      _this.previousValues.left = left;\n\n      _this.parent.notify(scroll, {\n        left: left\n      });\n    };\n  };\n\n  Scroll.prototype.onFreezeContentScroll = function (scrollTarget) {\n    var _this = this;\n\n    var element = scrollTarget;\n    return function (e) {\n      if (_this.content.querySelector('tbody') === null) {\n        return;\n      }\n\n      var target = e.target;\n      var top = target.scrollTop;\n\n      if (_this.previousValues.top === top) {\n        return;\n      }\n\n      element.scrollTop = top;\n      _this.previousValues.top = top;\n\n      if (_this.parent.isDestroyed) {\n        return;\n      }\n    };\n  };\n\n  Scroll.prototype.onWheelScroll = function (scrollTarget) {\n    var _this = this;\n\n    var element = scrollTarget;\n    return function (e) {\n      if (_this.content.querySelector('tbody') === null) {\n        return;\n      }\n\n      var top = element.scrollTop + (e.deltaMode === 1 ? e.deltaY * 30 : e.deltaY);\n\n      if (_this.previousValues.top === top) {\n        return;\n      }\n\n      e.preventDefault();\n      _this.parent.getContent().querySelector('.e-frozencontent').scrollTop = top;\n      element.scrollTop = top;\n      _this.previousValues.top = top;\n    };\n  };\n\n  Scroll.prototype.onTouchScroll = function (scrollTarget) {\n    var _this = this;\n\n    var element = scrollTarget;\n    return function (e) {\n      if (e.pointerType === 'mouse') {\n        return;\n      }\n\n      var cont;\n      var mHdr;\n\n      var pageXY = _this.getPointXY(e);\n\n      var top = element.scrollTop + (_this.pageXY.y - pageXY.y);\n      var left = element.scrollLeft + (_this.pageXY.x - pageXY.x);\n\n      if (_this.parent.getHeaderContent().contains(e.target)) {\n        mHdr = _this.parent.getFrozenColumns() ? _this.parent.getHeaderContent().querySelector('.e-movableheader') : _this.parent.getHeaderContent().querySelector('.e-headercontent');\n\n        if (_this.previousValues.left === left || left < 0 || mHdr.scrollWidth - mHdr.clientWidth < left) {\n          return;\n        }\n\n        e.preventDefault();\n        mHdr.scrollLeft = left;\n        element.scrollLeft = left;\n        _this.pageXY.x = pageXY.x;\n        _this.previousValues.left = left;\n      } else {\n        cont = _this.parent.getContent().querySelector('.e-frozencontent');\n\n        if (_this.previousValues.top === top && (top < 0 || cont.scrollHeight - cont.clientHeight < top) || top < 0 || cont.scrollHeight - cont.clientHeight < top) {\n          return;\n        }\n\n        e.preventDefault();\n        cont.scrollTop = top;\n        element.scrollTop = top;\n        _this.pageXY.y = pageXY.y;\n        _this.previousValues.top = top;\n      }\n    };\n  };\n\n  Scroll.prototype.setPageXY = function () {\n    var _this = this;\n\n    return function (e) {\n      if (e.pointerType === 'mouse') {\n        return;\n      }\n\n      _this.pageXY = _this.getPointXY(e);\n    };\n  };\n\n  Scroll.prototype.getPointXY = function (e) {\n    var pageXY = {\n      x: 0,\n      y: 0\n    };\n\n    if (e.touches && e.touches.length) {\n      pageXY.x = e.touches[0].pageX;\n      pageXY.y = e.touches[0].pageY;\n    } else {\n      pageXY.x = e.pageX;\n      pageXY.y = e.pageY;\n    }\n\n    return pageXY;\n  };\n\n  Scroll.prototype.wireEvents = function () {\n    var _this = this;\n\n    if (this.oneTimeReady) {\n      var frzCols = this.parent.getFrozenColumns();\n      this.content = this.parent.getContent().querySelector('.e-content');\n      this.header = this.parent.getHeaderContent().querySelector('.e-headercontent');\n      var mCont = this.content.querySelector('.e-movablecontent');\n      var fCont = this.content.querySelector('.e-frozencontent');\n      var mHdr = this.header.querySelector('.e-movableheader');\n\n      if (this.parent.frozenRows) {\n        EventHandler.add(frzCols ? mHdr : this.header, 'touchstart pointerdown', this.setPageXY(), this);\n        EventHandler.add(frzCols ? mHdr : this.header, 'touchmove pointermove', this.onTouchScroll(frzCols ? mCont : this.content), this);\n      }\n\n      if (frzCols) {\n        EventHandler.add(mCont, 'scroll', this.onContentScroll(mHdr), this);\n        EventHandler.add(mCont, 'scroll', this.onFreezeContentScroll(fCont), this);\n        EventHandler.add(fCont, 'scroll', this.onFreezeContentScroll(mCont), this);\n        EventHandler.add(mHdr, 'scroll', this.onContentScroll(mCont), this);\n        EventHandler.add(fCont, 'wheel', this.onWheelScroll(mCont), this);\n        EventHandler.add(fCont, 'touchstart pointerdown', this.setPageXY(), this);\n        EventHandler.add(fCont, 'touchmove pointermove', this.onTouchScroll(mCont), this);\n      } else {\n        EventHandler.add(this.content, 'scroll', this.onContentScroll(this.header), this);\n        EventHandler.add(this.header, 'scroll', this.onContentScroll(this.content), this);\n      }\n\n      if (this.parent.aggregates.length) {\n        EventHandler.add(this.parent.getFooterContent().firstChild, 'scroll', this.onContentScroll(this.content), this);\n      }\n\n      this.refresh();\n      this.oneTimeReady = false;\n    }\n\n    var table = this.parent.getContentTable();\n    var sLeft;\n    var sHeight;\n    var clientHeight;\n    getUpdateUsingRaf(function () {\n      sLeft = _this.header.scrollLeft;\n      sHeight = table.scrollHeight;\n      clientHeight = _this.parent.getContent().clientHeight;\n    }, function () {\n      if (!_this.parent.enableVirtualization) {\n        if (sHeight < clientHeight) {\n          addClass(table.querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n\n          if (_this.parent.getFrozenColumns()) {\n            addClass(_this.parent.getContent().querySelector('.e-movablecontent').querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n          }\n        }\n\n        if ((_this.parent.frozenRows > 0 || _this.parent.frozenColumns > 0) && _this.header.querySelector('.e-movableheader')) {\n          _this.header.querySelector('.e-movableheader').scrollLeft = _this.previousValues.left;\n        } else {\n          _this.header.scrollLeft = _this.previousValues.left;\n        }\n\n        _this.content.scrollLeft = _this.previousValues.left;\n        _this.content.scrollTop = _this.previousValues.top;\n      }\n\n      if (!_this.parent.enableColumnVirtualization) {\n        _this.content.scrollLeft = sLeft;\n      }\n\n      if (_this.parent.frozenColumns && _this.header.querySelector('.e-movableheader')) {\n        _this.header.querySelector('.e-movableheader').scrollLeft = _this.content.querySelector('.e-movablecontent').scrollLeft;\n      }\n    });\n    this.parent.isPreventScrollEvent = false;\n  };\n  /**\n   * @hidden\n   */\n\n\n  Scroll.prototype.getCssProperties = function (rtl) {\n    var css = {};\n    var enableRtl = isNullOrUndefined(rtl) ? this.parent.enableRtl : rtl;\n    css.border = enableRtl ? 'borderLeftWidth' : 'borderRightWidth';\n    css.padding = enableRtl ? 'paddingLeft' : 'paddingRight';\n    return css;\n  };\n\n  Scroll.prototype.ensureOverflow = function (content) {\n    if (this.parent.getFrozenColumns()) {\n      content.querySelector('.e-movablecontent').style.overflowY = this.parent.height === 'auto' ? 'auto' : 'scroll';\n\n      if (content.querySelector('.e-movablecontent').style.overflowY === 'scroll') {\n        this.setPadding();\n      }\n    } else {\n      content.style.overflowY = this.parent.height === 'auto' ? 'auto' : 'scroll';\n    }\n  };\n\n  Scroll.prototype.onPropertyChanged = function (e) {\n    if (e.module !== this.getModuleName()) {\n      return;\n    }\n\n    this.setPadding();\n    this.oneTimeReady = true;\n\n    if (this.parent.height === 'auto') {\n      this.removePadding();\n    }\n\n    this.wireEvents();\n    this.setHeight();\n    var width = 'width';\n    this.setWidth(!isNullOrUndefined(e.properties[width]));\n  };\n  /**\n   * @hidden\n   */\n\n\n  Scroll.prototype.destroy = function () {\n    var gridElement = this.parent.element;\n\n    if (!gridElement || !gridElement.querySelector('.e-gridheader') && !gridElement.querySelector('.e-gridcontent')) {\n      return;\n    }\n\n    this.removeEventListener(); //Remove padding\n\n    this.removePadding();\n    var cont = this.parent.getContent().querySelector('.e-content');\n    removeClass([this.parent.getHeaderContent().querySelector('.e-headercontent')], 'e-headercontent');\n    removeClass([cont], 'e-content'); //Remove height\n\n    cont.style.height = ''; //Remove width\n\n    this.parent.element.style.width = ''; //Remove Dom event\n\n    EventHandler.remove(cont, 'scroll', this.onContentScroll);\n  };\n  /**\n   * Function to get the scrollbar width of the browser.\n   * @return {number}\n   * @hidden\n   */\n\n\n  Scroll.getScrollBarWidth = function () {\n    return getScrollBarWidth();\n  };\n\n  return Scroll;\n}();\n\nexport { Scroll };","map":{"version":3,"sources":["D:/Projects/TCC/Finances/qub29a--run/node_modules/@syncfusion/ej2-grids/src/grid/actions/scroll.js"],"names":["Browser","EventHandler","addClass","removeClass","formatUnit","isNullOrUndefined","getScrollBarWidth","getUpdateUsingRaf","scroll","contentReady","uiUpdate","onEmpty","headerRefreshed","textWrapRefresh","virtualScrollEdit","infiniteScrollHandler","closeFilterDialog","lazyLoadScrollHandler","ColumnWidthService","Scroll","parent","lastScrollTop","previousValues","top","left","oneTimeReady","widthService","addEventListener","prototype","getModuleName","setWidth","uiupdate","element","style","width","setWidthToColumns","toolbarModule","toolbar","refreshOverflow","setHeight","mHdrHeight","content","getContent","querySelector","enableVirtualization","frozenRows","height","tbody","getHeaderContent","offsetHeight","ensureOverflow","setPadding","scrollWidth","getThreshold","cssProps","getCssProperties","border","padding","removePadding","rtl","hDiv","parentElement","footerDiv","getFooterContent","classList","contains","remove","refresh","getSiblingsHeight","appName","info","name","isDestroyed","on","wireEvents","onPropertyChanged","setScrollLeft","removeEventListener","off","frozenColumns","headerModule","getMovableHeader","scrollLeft","onContentScroll","scrollTarget","_this","isHeader","e","isPreventScrollEvent","infiniteScrollModule","enableInfiniteScrolling","notify","groupSettings","columns","length","enableLazyLoading","isDown","firstElementChild","scrollTop","scrollDown","target","sLimit","isFooter","header","onFreezeContentScroll","onWheelScroll","deltaMode","deltaY","preventDefault","onTouchScroll","pointerType","cont","mHdr","pageXY","getPointXY","y","x","getFrozenColumns","clientWidth","scrollHeight","clientHeight","setPageXY","touches","pageX","pageY","frzCols","mCont","fCont","add","aggregates","firstChild","table","getContentTable","sLeft","sHeight","querySelectorAll","enableColumnVirtualization","css","enableRtl","overflowY","module","properties","destroy","gridElement"],"mappings":"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","sourcesContent":["import { Browser, EventHandler } from '@syncfusion/ej2-base';\nimport { addClass, removeClass } from '@syncfusion/ej2-base';\nimport { formatUnit, isNullOrUndefined } from '@syncfusion/ej2-base';\nimport { getScrollBarWidth, getUpdateUsingRaf } from '../base/util';\nimport { scroll, contentReady, uiUpdate, onEmpty, headerRefreshed, textWrapRefresh, virtualScrollEdit, infiniteScrollHandler, closeFilterDialog } from '../base/constant';\nimport { lazyLoadScrollHandler } from '../base/constant';\nimport { ColumnWidthService } from '../services/width-controller';\n/**\n * The `Scroll` module is used to handle scrolling behaviour.\n */\nvar Scroll = /** @class */ (function () {\n    /**\n     * Constructor for the Grid scrolling.\n     * @hidden\n     */\n    function Scroll(parent) {\n        this.lastScrollTop = 0;\n        //To maintain scroll state on grid actions.\n        this.previousValues = { top: 0, left: 0 };\n        this.oneTimeReady = true;\n        this.parent = parent;\n        this.widthService = new ColumnWidthService(parent);\n        this.addEventListener();\n    }\n    /**\n     * For internal use only - Get the module name.\n     * @private\n     */\n    Scroll.prototype.getModuleName = function () {\n        return 'scroll';\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.setWidth = function (uiupdate) {\n        this.parent.element.style.width = formatUnit(this.parent.width);\n        if (uiupdate) {\n            this.widthService.setWidthToColumns();\n        }\n        if (this.parent.toolbarModule && this.parent.toolbarModule.toolbar &&\n            this.parent.toolbarModule.toolbar.element) {\n            this.parent.toolbarModule.toolbar.refreshOverflow();\n        }\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.setHeight = function () {\n        var mHdrHeight = 0;\n        var content = this.parent.getContent().querySelector('.e-content');\n        if (!this.parent.enableVirtualization && this.parent.frozenRows && this.parent.height !== 'auto') {\n            var tbody = this.parent.getHeaderContent().querySelector('tbody');\n            mHdrHeight = tbody ? tbody.offsetHeight : 0;\n            content.style.height = formatUnit(this.parent.height - mHdrHeight);\n        }\n        else {\n            content.style.height = formatUnit(this.parent.height);\n        }\n        this.ensureOverflow(content);\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.setPadding = function () {\n        var content = this.parent.getHeaderContent();\n        var scrollWidth = Scroll.getScrollBarWidth() - this.getThreshold();\n        var cssProps = this.getCssProperties();\n        content.querySelector('.e-headercontent').style[cssProps.border] = scrollWidth > 0 ? '1px' : '0px';\n        content.style[cssProps.padding] = scrollWidth > 0 ? scrollWidth + 'px' : '0px';\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.removePadding = function (rtl) {\n        var cssProps = this.getCssProperties(rtl);\n        var hDiv = this.parent.getHeaderContent().querySelector('.e-headercontent');\n        hDiv.style[cssProps.border] = '';\n        hDiv.parentElement.style[cssProps.padding] = '';\n        var footerDiv = this.parent.getFooterContent();\n        if (footerDiv && footerDiv.classList.contains('e-footerpadding')) {\n            footerDiv.classList.remove('e-footerpadding');\n        }\n    };\n    /**\n     * Refresh makes the Grid adoptable with the height of parent container.\n     *\n     * > The [`height`](grid/#height/) must be set to 100%.\n     * @return\n     */\n    Scroll.prototype.refresh = function () {\n        if (this.parent.height !== '100%') {\n            return;\n        }\n        var content = this.parent.getContent();\n        this.parent.element.style.height = '100%';\n        var height = this.widthService.getSiblingsHeight(content);\n        content.style.height = 'calc(100% - ' + height + 'px)'; //Set the height to the '.e-gridcontent';\n    };\n    Scroll.prototype.getThreshold = function () {\n        /* Some browsers places the scroller outside the content,\n         * hence the padding should be adjusted.*/\n        var appName = Browser.info.name;\n        if (appName === 'mozilla') {\n            return 0.5;\n        }\n        return 1;\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.addEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.on(onEmpty, this.wireEvents, this);\n        this.parent.on(contentReady, this.wireEvents, this);\n        this.parent.on(uiUpdate, this.onPropertyChanged, this);\n        this.parent.on(textWrapRefresh, this.wireEvents, this);\n        this.parent.on(headerRefreshed, this.setScrollLeft, this);\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.removeEventListener = function () {\n        if (this.parent.isDestroyed) {\n            return;\n        }\n        this.parent.off(onEmpty, this.wireEvents);\n        this.parent.off(contentReady, this.wireEvents);\n        this.parent.off(uiUpdate, this.onPropertyChanged);\n        this.parent.off(textWrapRefresh, this.wireEvents);\n        this.parent.off(headerRefreshed, this.setScrollLeft);\n    };\n    Scroll.prototype.setScrollLeft = function () {\n        if (this.parent.frozenColumns) {\n            this.parent.headerModule.getMovableHeader().scrollLeft = this.previousValues.left;\n        }\n        else {\n            this.parent.getHeaderContent().querySelector('.e-headercontent').scrollLeft = this.previousValues.left;\n        }\n    };\n    Scroll.prototype.onContentScroll = function (scrollTarget) {\n        var _this = this;\n        var element = scrollTarget;\n        var isHeader = element.classList.contains('e-headercontent');\n        return function (e) {\n            if (_this.content.querySelector('tbody') === null || _this.parent.isPreventScrollEvent) {\n                return;\n            }\n            if (!isNullOrUndefined(_this.parent.infiniteScrollModule) && _this.parent.enableInfiniteScrolling) {\n                _this.parent.notify(infiniteScrollHandler, e);\n            }\n            if (_this.parent.groupSettings.columns.length && _this.parent.groupSettings.enableLazyLoading) {\n                var isDown = _this.previousValues.top < _this.parent.getContent().firstElementChild.scrollTop;\n                _this.parent.notify(lazyLoadScrollHandler, { scrollDown: isDown });\n            }\n            _this.parent.notify(virtualScrollEdit, {});\n            var target = e.target;\n            var left = target.scrollLeft;\n            var sLimit = target.scrollWidth;\n            var isFooter = target.classList.contains('e-summarycontent');\n            if (_this.previousValues.left === left) {\n                _this.previousValues.top = !isHeader ? _this.previousValues.top : target.scrollTop;\n                return;\n            }\n            _this.parent.notify(closeFilterDialog, e);\n            element.scrollLeft = left;\n            if (isFooter) {\n                _this.header.scrollLeft = left;\n            }\n            _this.previousValues.left = left;\n            _this.parent.notify(scroll, { left: left });\n        };\n    };\n    Scroll.prototype.onFreezeContentScroll = function (scrollTarget) {\n        var _this = this;\n        var element = scrollTarget;\n        return function (e) {\n            if (_this.content.querySelector('tbody') === null) {\n                return;\n            }\n            var target = e.target;\n            var top = target.scrollTop;\n            if (_this.previousValues.top === top) {\n                return;\n            }\n            element.scrollTop = top;\n            _this.previousValues.top = top;\n            if (_this.parent.isDestroyed) {\n                return;\n            }\n        };\n    };\n    Scroll.prototype.onWheelScroll = function (scrollTarget) {\n        var _this = this;\n        var element = scrollTarget;\n        return function (e) {\n            if (_this.content.querySelector('tbody') === null) {\n                return;\n            }\n            var top = element.scrollTop + (e.deltaMode === 1 ? e.deltaY * 30 : e.deltaY);\n            if (_this.previousValues.top === top) {\n                return;\n            }\n            e.preventDefault();\n            _this.parent.getContent().querySelector('.e-frozencontent').scrollTop = top;\n            element.scrollTop = top;\n            _this.previousValues.top = top;\n        };\n    };\n    Scroll.prototype.onTouchScroll = function (scrollTarget) {\n        var _this = this;\n        var element = scrollTarget;\n        return function (e) {\n            if (e.pointerType === 'mouse') {\n                return;\n            }\n            var cont;\n            var mHdr;\n            var pageXY = _this.getPointXY(e);\n            var top = element.scrollTop + (_this.pageXY.y - pageXY.y);\n            var left = element.scrollLeft + (_this.pageXY.x - pageXY.x);\n            if (_this.parent.getHeaderContent().contains(e.target)) {\n                mHdr = _this.parent.getFrozenColumns() ?\n                    _this.parent.getHeaderContent().querySelector('.e-movableheader') :\n                    _this.parent.getHeaderContent().querySelector('.e-headercontent');\n                if (_this.previousValues.left === left || (left < 0 || (mHdr.scrollWidth - mHdr.clientWidth) < left)) {\n                    return;\n                }\n                e.preventDefault();\n                mHdr.scrollLeft = left;\n                element.scrollLeft = left;\n                _this.pageXY.x = pageXY.x;\n                _this.previousValues.left = left;\n            }\n            else {\n                cont = _this.parent.getContent().querySelector('.e-frozencontent');\n                if (_this.previousValues.top === top && (top < 0 || (cont.scrollHeight - cont.clientHeight) < top)\n                    || (top < 0 || (cont.scrollHeight - cont.clientHeight) < top)) {\n                    return;\n                }\n                e.preventDefault();\n                cont.scrollTop = top;\n                element.scrollTop = top;\n                _this.pageXY.y = pageXY.y;\n                _this.previousValues.top = top;\n            }\n        };\n    };\n    Scroll.prototype.setPageXY = function () {\n        var _this = this;\n        return function (e) {\n            if (e.pointerType === 'mouse') {\n                return;\n            }\n            _this.pageXY = _this.getPointXY(e);\n        };\n    };\n    Scroll.prototype.getPointXY = function (e) {\n        var pageXY = { x: 0, y: 0 };\n        if (e.touches && e.touches.length) {\n            pageXY.x = e.touches[0].pageX;\n            pageXY.y = e.touches[0].pageY;\n        }\n        else {\n            pageXY.x = e.pageX;\n            pageXY.y = e.pageY;\n        }\n        return pageXY;\n    };\n    Scroll.prototype.wireEvents = function () {\n        var _this = this;\n        if (this.oneTimeReady) {\n            var frzCols = this.parent.getFrozenColumns();\n            this.content = this.parent.getContent().querySelector('.e-content');\n            this.header = this.parent.getHeaderContent().querySelector('.e-headercontent');\n            var mCont = this.content.querySelector('.e-movablecontent');\n            var fCont = this.content.querySelector('.e-frozencontent');\n            var mHdr = this.header.querySelector('.e-movableheader');\n            if (this.parent.frozenRows) {\n                EventHandler.add(frzCols ? mHdr : this.header, 'touchstart pointerdown', this.setPageXY(), this);\n                EventHandler.add(frzCols ? mHdr : this.header, 'touchmove pointermove', this.onTouchScroll(frzCols ? mCont : this.content), this);\n            }\n            if (frzCols) {\n                EventHandler.add(mCont, 'scroll', this.onContentScroll(mHdr), this);\n                EventHandler.add(mCont, 'scroll', this.onFreezeContentScroll(fCont), this);\n                EventHandler.add(fCont, 'scroll', this.onFreezeContentScroll(mCont), this);\n                EventHandler.add(mHdr, 'scroll', this.onContentScroll(mCont), this);\n                EventHandler.add(fCont, 'wheel', this.onWheelScroll(mCont), this);\n                EventHandler.add(fCont, 'touchstart pointerdown', this.setPageXY(), this);\n                EventHandler.add(fCont, 'touchmove pointermove', this.onTouchScroll(mCont), this);\n            }\n            else {\n                EventHandler.add(this.content, 'scroll', this.onContentScroll(this.header), this);\n                EventHandler.add(this.header, 'scroll', this.onContentScroll(this.content), this);\n            }\n            if (this.parent.aggregates.length) {\n                EventHandler.add(this.parent.getFooterContent().firstChild, 'scroll', this.onContentScroll(this.content), this);\n            }\n            this.refresh();\n            this.oneTimeReady = false;\n        }\n        var table = this.parent.getContentTable();\n        var sLeft;\n        var sHeight;\n        var clientHeight;\n        getUpdateUsingRaf(function () {\n            sLeft = _this.header.scrollLeft;\n            sHeight = table.scrollHeight;\n            clientHeight = _this.parent.getContent().clientHeight;\n        }, function () {\n            if (!_this.parent.enableVirtualization) {\n                if (sHeight < clientHeight) {\n                    addClass(table.querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n                    if (_this.parent.getFrozenColumns()) {\n                        addClass(_this.parent.getContent().querySelector('.e-movablecontent').querySelectorAll('tr:last-child td'), 'e-lastrowcell');\n                    }\n                }\n                if ((_this.parent.frozenRows > 0 || _this.parent.frozenColumns > 0) && _this.header.querySelector('.e-movableheader')) {\n                    _this.header.querySelector('.e-movableheader').scrollLeft = _this.previousValues.left;\n                }\n                else {\n                    _this.header.scrollLeft = _this.previousValues.left;\n                }\n                _this.content.scrollLeft = _this.previousValues.left;\n                _this.content.scrollTop = _this.previousValues.top;\n            }\n            if (!_this.parent.enableColumnVirtualization) {\n                _this.content.scrollLeft = sLeft;\n            }\n            if (_this.parent.frozenColumns && _this.header.querySelector('.e-movableheader')) {\n                _this.header.querySelector('.e-movableheader').scrollLeft =\n                    _this.content.querySelector('.e-movablecontent').scrollLeft;\n            }\n        });\n        this.parent.isPreventScrollEvent = false;\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.getCssProperties = function (rtl) {\n        var css = {};\n        var enableRtl = isNullOrUndefined(rtl) ? this.parent.enableRtl : rtl;\n        css.border = enableRtl ? 'borderLeftWidth' : 'borderRightWidth';\n        css.padding = enableRtl ? 'paddingLeft' : 'paddingRight';\n        return css;\n    };\n    Scroll.prototype.ensureOverflow = function (content) {\n        if (this.parent.getFrozenColumns()) {\n            content.querySelector('.e-movablecontent').style.overflowY = this.parent.height === 'auto' ? 'auto' : 'scroll';\n            if (content.querySelector('.e-movablecontent').style.overflowY === 'scroll') {\n                this.setPadding();\n            }\n        }\n        else {\n            content.style.overflowY = this.parent.height === 'auto' ? 'auto' : 'scroll';\n        }\n    };\n    Scroll.prototype.onPropertyChanged = function (e) {\n        if (e.module !== this.getModuleName()) {\n            return;\n        }\n        this.setPadding();\n        this.oneTimeReady = true;\n        if (this.parent.height === 'auto') {\n            this.removePadding();\n        }\n        this.wireEvents();\n        this.setHeight();\n        var width = 'width';\n        this.setWidth(!isNullOrUndefined(e.properties[width]));\n    };\n    /**\n     * @hidden\n     */\n    Scroll.prototype.destroy = function () {\n        var gridElement = this.parent.element;\n        if (!gridElement || (!gridElement.querySelector('.e-gridheader') && !gridElement.querySelector('.e-gridcontent'))) {\n            return;\n        }\n        this.removeEventListener();\n        //Remove padding\n        this.removePadding();\n        var cont = this.parent.getContent().querySelector('.e-content');\n        removeClass([this.parent.getHeaderContent().querySelector('.e-headercontent')], 'e-headercontent');\n        removeClass([cont], 'e-content');\n        //Remove height\n        cont.style.height = '';\n        //Remove width\n        this.parent.element.style.width = '';\n        //Remove Dom event\n        EventHandler.remove(cont, 'scroll', this.onContentScroll);\n    };\n    /**\n     * Function to get the scrollbar width of the browser.\n     * @return {number}\n     * @hidden\n     */\n    Scroll.getScrollBarWidth = function () {\n        return getScrollBarWidth();\n    };\n    return Scroll;\n}());\nexport { Scroll };\n"]},"metadata":{},"sourceType":"module"}